import{r as c,S as d,j as e}from"./index-C_P7ACqV.js";import{g as K,b as X}from"./settings-BAS489GI.js";import{c as Z,v as ee,b as D,a as O,T as j,C as Y,I as R,B as G}from"./ButtonGroup-Bgv38W4W.js";import{F as V}from"./FormLayout-D8d9gNoU.js";import{j as ae,e as te,I as ne,T as B,P as se}from"./Page-DvtG3tiZ.js";import{S as U}from"./Select-CYy_g-2H.js";import{C as ie,h as oe,a as _}from"./Checkbox-CxOvbNU9.js";import{M as $}from"./Modal-CEg-nmC-.js";import{T as re,L as q}from"./Layout-DNtBfCJd.js";import{u as le,a as ce,F as de}from"./Frame-DZPAd0zi.js";import{b as ue,u as ge,a as me,e as he}from"./components-CgIgXmEm.js";import{B as fe}from"./Banner-4MJ0AgcI.js";import"./context-Cuq_S-Fv.js";import"./CSSTransition-BI2FqCs3.js";import"./InlineGrid-B9iUkR0h.js";import"./Image-04wlLHHA.js";import"./LegacyStack-g1cAJ6OF.js";import"./index-CeTaglFb.js";import"./banner-context-B9x05WVp.js";var pe={ChoiceChildren:"Polaris-ChoiceList__ChoiceChildren"},A={RadioButton:"Polaris-RadioButton",Input:"Polaris-RadioButton__Input",Backdrop:"Polaris-RadioButton__Backdrop",ChoiceLabel:"Polaris-RadioButton__ChoiceLabel",toneMagic:"Polaris-RadioButton--toneMagic"};function Se({ariaDescribedBy:n,label:r,labelHidden:t,helpText:f,checked:u,disabled:s,onChange:g,onFocus:o,onBlur:m,id:v,name:a,value:k,fill:S,bleed:y,bleedBlockStart:L,bleedBlockEnd:N,bleedInlineStart:E,bleedInlineEnd:b,tone:x}){const w=c.useId(),T=v??w,I=a||T,F=c.useRef(null),P=()=>{m&&m()};function i({currentTarget:M}){g&&g(M.checked,T)}const l=[];f&&l.push(oe(T)),n&&l.push(n);const h=l.length?l.join(" "):void 0,p=Z(A.Input,x&&A[ee("tone",x)]),C={helpText:f,bleed:y,bleedBlockStart:L,bleedBlockEnd:N,bleedInlineStart:E,bleedInlineEnd:b};return d.createElement(ie,Object.assign({label:r,labelHidden:t,disabled:s,id:T,labelClassName:A.ChoiceLabel,fill:S},C,u?{tone:x}:{}),d.createElement("span",{className:A.RadioButton},d.createElement("input",{id:T,name:I,value:k,type:"radio",checked:u,disabled:s,className:p,onChange:i,onFocus:o,onBlur:P,"aria-describedby":h,ref:F}),d.createElement("span",{className:A.Backdrop})))}function H({title:n,titleHidden:r,allowMultiple:t,choices:f,selected:u,onChange:s=be,error:g,disabled:o=!1,name:m,tone:v}){const a=t?_:Se,k=c.useId(),S=m??k,y=t?`${S}[]`:S,L=n?d.createElement(O,{as:"legend",paddingBlockEnd:{xs:"0",md:"100"}},d.createElement(j,{as:"span",variant:"bodyMd",visuallyHidden:r},n)):null,N=f.map(b=>{const{value:x,id:w,label:T,helpText:I,disabled:F,describedByError:P}=b;function i(C){s(ve(b,C,u,t),S)}const l=W(b,u),h=b.renderChildren?b.renderChildren(l):null,p=h?d.createElement("div",{className:pe.ChoiceChildren},d.createElement(O,{paddingBlockStart:{xs:"400",md:"0"}},h)):null;return d.createElement("li",{key:x},d.createElement(ae,{marginBlockEnd:I?{xs:"100",md:"0"}:{xs:"0"}},d.createElement(a,{name:y,value:x,id:w,label:T,disabled:F||o,fill:{xs:!0,sm:!1},checked:W(b,u),helpText:I,onChange:i,ariaDescribedBy:g&&P?te(y):null,tone:v}),p))}),E=g&&d.createElement(O,{paddingBlockStart:{xs:"0",md:"100"},paddingBlockEnd:"200"},d.createElement(ne,{message:g,fieldID:y}));return d.createElement(D,{as:"fieldset",gap:{xs:"400",md:"0"},"aria-invalid":g!=null,id:y},L,d.createElement(D,{as:"ul",gap:{xs:"400",md:"0"}},N),E)}function be(){}function W({value:n},r){return r.includes(n)}function ve({value:n},r,t,f=!1){return r?f?[...t,n]:[n]:t.filter(u=>u!==n)}var ye={Divider:"Polaris-Divider"};const Q=({borderColor:n="border-secondary",borderWidth:r="025"})=>{const t=n==="transparent"?n:`var(--p-color-${n})`;return d.createElement("hr",{className:ye.Divider,style:{borderBlockStart:`var(--p-border-width-${r}) solid ${t}`}})},xe=c.memo(function(r){const t=c.useId(),{showToast:f,hideToast:u}=le();return ce(()=>(f({id:t,...r}),()=>{u({id:t})}),[r]),null});function Te({initialValues:n,onSubmit:r,onFormChange:t,hasUnsavedChanges:f,isSubmitting:u}){const[s,g]=c.useState(n||{});c.useEffect(()=>{n&&g(n)},[n]),c.useEffect(()=>{t(s)},[s,t]);const o=(a,k)=>{g(S=>({...S,[a]:k}))},m=a=>a!=null?a.toString():"",v=a=>{a.preventDefault(),r(s)};return e.jsx(Y,{children:e.jsx("form",{onSubmit:v,children:e.jsxs(D,{gap:"6",children:[e.jsx(j,{variant:"headingMd",fontWeight:"semibold",children:"General Settings"}),e.jsxs(V,{children:[e.jsx(B,{label:"Lead Time (days)",type:"number",value:m(s.leadTime),onChange:a=>o("leadTime",parseInt(a)||0),helpText:"Average days between ordering and receiving inventory",min:1,autoComplete:"off"}),e.jsx(U,{label:"Restock Strategy",options:[{label:"Economic Order Quantity",value:"economic"},{label:"Just-in-Time",value:"jit"},{label:"Fixed Interval",value:"fixed"},{label:"Fixed Quantity",value:"quantity"}],value:s.restockStrategy||"economic",onChange:a=>o("restockStrategy",a),helpText:"Strategy used to determine when and how much to reorder"}),e.jsxs(R,{wrap:!1,gap:"2",children:[e.jsx(B,{label:"Low Stock Threshold (days)",type:"number",value:m(s.lowStockThreshold),onChange:a=>o("lowStockThreshold",parseInt(a)||0),min:1,autoComplete:"off"}),e.jsx(B,{label:"Critical Stock Threshold (days)",type:"number",value:m(s.criticalStockThreshold),onChange:a=>o("criticalStockThreshold",parseInt(a)||0),min:1,autoComplete:"off"})]}),e.jsx(H,{title:"Notification Preferences",allowMultiple:!0,choices:[{label:"Email",value:"email"},{label:"SMS",value:"sms"},{label:"In-app",value:"app"},{label:"Slack",value:"slack"}],selected:s.notificationPreferences||[],onChange:a=>o("notificationPreferences",a)})]}),e.jsx(Q,{}),e.jsxs(D,{gap:"4",children:[e.jsxs(R,{align:"space-between",children:[e.jsx(j,{variant:"headingMd",fontWeight:"semibold",children:"Advanced Settings"}),e.jsx(_,{label:"Enable Advanced Features",checked:s.advancedEnabled||!1,onChange:a=>o("advancedEnabled",a)})]}),s.advancedEnabled&&e.jsxs(V,{children:[e.jsx(B,{label:"Safety Stock Days",type:"number",value:m(s.safetyStockDays),onChange:a=>o("safetyStockDays",parseInt(a)||0),helpText:"Extra inventory to protect against variability",min:0,autoComplete:"off"}),e.jsx(B,{label:"Service Level (%)",type:"number",value:m(s.serviceLevelPercent),onChange:a=>o("serviceLevelPercent",parseInt(a)||0),helpText:"Target percentage of customer demand to be satisfied",min:50,max:100,autoComplete:"off"}),e.jsx(B,{label:"Forecast Days",type:"number",value:m(s.forecastDays),onChange:a=>o("forecastDays",parseInt(a)||0),helpText:"Number of days to forecast demand",min:7,autoComplete:"off"})]})]}),e.jsx(Q,{}),e.jsxs(D,{gap:"4",children:[e.jsx(j,{variant:"headingMd",fontWeight:"semibold",children:"AI Tagging Settings"}),e.jsxs(V,{children:[e.jsx(_,{label:"Enable AI Product Tagging",checked:s.aiTaggingEnabled!==!1,onChange:a=>o("aiTaggingEnabled",a),helpText:"Use AI to automatically categorize and tag products"}),s.aiTaggingEnabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsx(U,{label:"Tagging Frequency",options:[{label:"Daily",value:"daily"},{label:"Weekly",value:"weekly"},{label:"On Product Update",value:"onUpdate"},{label:"Manual Only",value:"manual"}],value:s.aiTaggingFrequency||"daily",onChange:a=>o("aiTaggingFrequency",a)}),e.jsx(B,{label:"Batch Size",type:"number",value:m(s.aiTaggingBatchSize),onChange:a=>o("aiTaggingBatchSize",a),helpText:"Number of products to process in each batch",min:1,max:200,autoComplete:"off"}),e.jsx(H,{title:"AI Data Sources",allowMultiple:!0,choices:[{label:"Product Metadata",value:"metadata"},{label:"Sales History",value:"sales"},{label:"Profit Margins",value:"margins"},{label:"Seasonal Patterns",value:"seasonal"},{label:"Lead Times",value:"leadtime"}],selected:s.aiTaggingDataSources||[],onChange:a=>o("aiTaggingDataSources",a)})]})]})]}),e.jsx(R,{align:"end",children:e.jsx(G,{submit:!0,primary:!0,loading:u,disabled:!f||u,children:"Save Settings"})})]})})})}function je({isOpen:n,onConfirm:r,onCancel:t}){return e.jsx($,{open:n,onClose:t,title:"Unsaved Changes",primaryAction:{content:"Discard changes",destructive:!0,onAction:r},secondaryActions:[{content:"Keep editing",onAction:t}],children:e.jsx($.Section,{children:e.jsx(re,{children:e.jsx("p",{children:"You have unsaved changes that will be lost if you leave this page. Are you sure you want to discard your changes?"})})})})}function Ce({isActive:n,onDismiss:r,message:t="Settings saved successfully"}){return n?e.jsx(xe,{content:t,onDismiss:r,duration:3e3}):null}function Ue(){const n=ue(),{initialSettings:r}=ge(),t=me(),f=he(),[u,s]=c.useState(!1),[g,o]=c.useState(!1),[m,v]=c.useState(!1),[a,k]=c.useState(null),[S,y]=c.useState(!1),[L,N]=c.useState(r),[E,b]=c.useState({}),[x,w]=c.useState(null);c.useRef(null),c.useEffect(()=>{var h,p,C,M,z,J;const i=K();N(i);const l={leadTime:((h=i.leadTime)==null?void 0:h.toString())||"7",notificationPreferences:i.notificationPreferences||["email"],advancedEnabled:i.advancedEnabled||!1,safetyStockDays:((p=i.safetyStockDays)==null?void 0:p.toString())||"14",serviceLevelPercent:((C=i.serviceLevelPercent)==null?void 0:C.toString())||"95",lowStockThreshold:((M=i.lowStockThreshold)==null?void 0:M.toString())||"7",criticalStockThreshold:((z=i.criticalStockThreshold)==null?void 0:z.toString())||"3",forecastDays:((J=i.forecastDays)==null?void 0:J.toString())||"30",restockStrategy:i.restockStrategy||"economic",aiTaggingEnabled:i.aiTaggingEnabled??!0,aiTaggingFrequency:i.aiTaggingFrequency||"daily",aiTaggingBatchSize:i.aiTaggingBatchSize||"50",aiTaggingDataSources:i.aiTaggingDataSources||["metadata","sales","margins","seasonal","leadtime"]};b(l),w(JSON.parse(JSON.stringify(l))),o(!1)},[]),c.useEffect(()=>{const i=l=>{if(g)return l.preventDefault(),l.returnValue="You have unsaved changes that will be lost if you leave this page.",l.returnValue};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i)}},[g]),c.useEffect(()=>{t!=null&&t.success&&S&&(y(!1),s(!0),X(t.settings),w(JSON.parse(JSON.stringify(E))),o(!1))},[t,S,E]);const T=i=>{y(!0);const l=new FormData;Object.entries(i).forEach(([h,p])=>{Array.isArray(p)?p.forEach(C=>l.append(h,C)):typeof p=="boolean"?l.append(h,p.toString()):l.append(h,p)}),f(l,{method:"post"})},I=i=>{if(b(i),x){const l=JSON.stringify(i),h=JSON.stringify(x);o(l!==h)}},F=()=>{g?(k("/app"),v(!0)):n("/app")},P=()=>{v(!1),a&&n(a)};return e.jsx(de,{children:e.jsxs(se,{title:"Settings",backAction:{content:"Dashboard",onAction:F},primaryAction:e.jsx(G,{onClick:()=>n("/app/sales-analysis"),children:"View Sales Analysis"}),children:[e.jsxs(D,{gap:"5",children:[(t==null?void 0:t.success)===!1&&e.jsx(fe,{tone:"critical",children:t.message||"There was an error saving your settings."}),e.jsxs(q,{children:[e.jsx(q.Section,{children:e.jsx(Te,{initialValues:E,onSubmit:T,onFormChange:I,hasUnsavedChanges:g,isSubmitting:S})}),e.jsx(q.Section,{secondary:!0,children:e.jsx(Y,{children:e.jsxs(D,{gap:"4",children:[e.jsx(j,{variant:"headingMd",fontWeight:"semibold",children:"Settings Help"}),e.jsx(j,{children:"Configure your inventory management preferences here. These settings affect how the app calculates reorder points, safety stock, and when to alert you about low inventory."}),e.jsxs(j,{children:[e.jsx("strong",{children:"Lead Time:"})," The average time it takes from placing an order to receiving it at your warehouse."]}),e.jsxs(j,{children:[e.jsx("strong",{children:"Safety Stock:"})," Extra inventory kept to reduce the risk of stockouts due to uncertainty in demand and supply."]}),e.jsxs(j,{children:[e.jsx("strong",{children:"AI Tagging:"})," Enables the system to automatically categorize and tag your products based on multiple data sources."]})]})})})]})]}),e.jsx(je,{isOpen:m,onConfirm:P,onCancel:()=>v(!1)}),e.jsx(Ce,{isActive:u,onDismiss:()=>s(!1),message:"Settings saved successfully"})]})})}export{Ue as default};
