import{j as t}from"./index-C_P7ACqV.js";import{u as E,L as Q}from"./components-CgIgXmEm.js";import{B as V,P as B}from"./Page-DvtG3tiZ.js";import{L as d}from"./Layout-DNtBfCJd.js";import{C as y,b as f,T as a,B as W}from"./ButtonGroup-Bgv38W4W.js";import{B as M}from"./Banner-4MJ0AgcI.js";import{E as O}from"./EmptyState-D5BdA5_5.js";import{D as Y}from"./DataTable-DAB58wxr.js";import"./banner-context-B9x05WVp.js";import"./Image-04wlLHHA.js";import"./index-CeTaglFb.js";import"./Sticky-q5uRhpIz.js";const n=(i,s=0)=>{if(i==null)return s;const o=parseFloat(i);return isNaN(o)||!isFinite(o)?s:o},q=(i,s=1)=>{if(!i||typeof i!="string")return s;try{return parseInt(i.replace(/\D/g,""))||s}catch{return s}};function se(){const{products:i,error:s}=E(),o=(i==null?void 0:i.edges)&&Array.isArray(i.edges)&&i.edges.length>0,c=o?i.edges.map(({node:e})=>{var R,$;if(!e)return null;const g=((($=(R=e.variants)==null?void 0:R.edges)==null?void 0:$[0])||{}).node||{},x=n(g.inventoryQuantity,0),l=n(g.price,0),A=q(e.id,1),m=Math.max(.1,.5+A%3),v=m>0?Math.ceil(x/m):0,D=v>0?n(365/Math.max(v,1),0):0,S=Math.max(0,l*.6),N=Math.max(0,l-S),C=l>0?N/l*100:0,T=Math.max(0,x*S),L=Math.max(0,Math.ceil(m*14)),w=Math.max(0,x-L),k=Math.max(0,w*S),z=Math.max(0,m*l),I=v<7,F=I?z*7:0,U=Math.max(0,m*30);let h,p,u=0;return I?(h="Restock Now",p=`Restocking immediately can save ~$${n(F).toFixed(0)} in lost sales`,u=F):w>10&&k>300?(h="Consider Discount",p=`Ties up ~$${n(k).toFixed(0)} in capital monthly`,u=k):D<6&&C<30?(h="Review Pricing",p="Low margin and turnover - consider price adjustment",u=n(U*(l*.1))):(h="Optimal",p="Current inventory levels are profit-optimized",u=0),{id:e.id||`unknown-${Date.now()}`,title:e.title||"Unknown Product",price:l,currentStock:x,margin:n(C).toFixed(1),inventoryValue:T,avgDailySales:n(m).toFixed(1),daysOfSupply:v,stockTurnover:n(D).toFixed(1),recommendation:h,recommendationDetail:p,financialImpact:u,stockoutRisk:I,excessStock:w,excessInventoryValue:k}}).filter(Boolean):[];c.sort((e,r)=>{const g=n(e==null?void 0:e.financialImpact,0);return n(r==null?void 0:r.financialImpact,0)-g});const P=c.reduce((e,r)=>!r||r.financialImpact===void 0?e:e+n(r.financialImpact,0),0),j={restock:c.filter(e=>e&&e.recommendation==="Restock Now"),discount:c.filter(e=>e&&e.recommendation==="Consider Discount"),pricing:c.filter(e=>e&&e.recommendation==="Review Pricing"),optimal:c.filter(e=>e&&e.recommendation==="Optimal")},b=c.map(e=>e?[e.title||"Unknown",`$${n(e.price).toFixed(2)}`,n(e.currentStock,0),n(e.daysOfSupply,0),`${e.margin||"0"}%`,t.jsx(V,{status:e.recommendation==="Optimal"?"success":e.recommendation==="Restock Now"?"critical":"warning",children:e.recommendation||"Unknown"}),e.recommendationDetail||"No recommendation available",`$${n(e.financialImpact).toFixed(0)}`]:Array(8).fill(""));return s||!o?t.jsx(B,{title:"Profit-Optimized Stock Recommendations",backAction:{content:"Inventory Dashboard",url:"/app"},children:t.jsx(d,{children:t.jsx(d.Section,{children:t.jsx(y,{children:t.jsx(f,{gap:"400",children:s?t.jsx(M,{status:"critical",children:t.jsx("p",{children:s})}):t.jsx(O,{heading:"No product data available",image:"",children:t.jsx("p",{children:"We couldn't find any products to analyze. Add products to your store to see profit recommendations."})})})})})})}):t.jsx(B,{title:"Profit-Optimized Stock Recommendations",backAction:{content:"Inventory Dashboard",url:"/app"},children:t.jsxs(d,{children:[t.jsx(d.Section,{children:t.jsx(y,{children:t.jsxs(f,{gap:"500",children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{as:"h2",variant:"headingMd",children:"Profit Optimization Potential"}),t.jsx("div",{style:{display:"flex",alignItems:"center"},children:t.jsxs(a,{variant:"heading2xl",color:"success",children:["$",n(P).toFixed(0)]})})]}),t.jsxs(a,{as:"p",children:["Taking action on these recommendations could improve your cash flow and profitability by approximately $",n(P).toFixed(0)," over the next 30 days."]})]})})}),t.jsx(d.Section,{children:j.restock.length>0&&t.jsx(y,{children:t.jsxs(f,{gap:"400",children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{as:"h2",variant:"headingMd",children:"Prevent Lost Sales: Restock Soon"}),t.jsx(Q,{to:"/app/order-automation",children:t.jsx(W,{primary:!0,children:"Create Purchase Order"})})]}),j.restock.map(e=>!e||!e.id?null:t.jsx(M,{title:e.title||"Unknown Product",status:"critical",children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(a,{variant:"bodyMd",children:["Restocking now can save approximately ",t.jsxs("strong",{children:["$",n(e.financialImpact).toFixed(0)]})," in lost sales."]}),t.jsxs(a,{variant:"bodyMd",children:["Current stock: ",n(e.currentStock)," units (",n(e.daysOfSupply)," days)"]})]})},e.id))]})})}),t.jsx(d.Section,{children:j.discount.length>0&&t.jsx(y,{children:t.jsxs(f,{gap:"400",children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:t.jsx(a,{as:"h2",variant:"headingMd",children:"Free Up Capital: Consider Discounting"})}),j.discount.map(e=>!e||!e.id?null:t.jsx(M,{title:e.title||"Unknown Product",status:"warning",children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(a,{variant:"bodyMd",children:["You have ",n(e.excessStock)," excess units tying up ",t.jsxs("strong",{children:["$",n(e.excessInventoryValue).toFixed(0)]})," in capital."]}),t.jsx(a,{variant:"bodyMd",children:"Consider a discount promotion to increase turnover."})]})},e.id))]})})}),t.jsx(d.Section,{children:t.jsx(y,{children:t.jsxs(f,{gap:"500",children:[t.jsx(a,{as:"h2",variant:"headingMd",children:"Complete Profit Analysis"}),b.length>0?t.jsx(Y,{columnContentTypes:["text","numeric","numeric","numeric","numeric","text","text","numeric"],headings:["Product","Price","Stock","Days Supply","Margin %","Recommendation","Detail","Financial Impact"],rows:b}):t.jsx(O,{heading:"No data to display",children:t.jsx("p",{children:"There are no products with profit analysis data available."})}),t.jsx(a,{variant:"bodySm",children:"Financial impact is calculated based on potential lost sales for stockouts and tied-up capital for excess inventory. All recommendations aim to maximize profit and cash flow efficiency."})]})})})]})})}export{se as default};
