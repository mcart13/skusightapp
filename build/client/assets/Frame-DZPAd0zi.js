import{S as t,r as s}from"./index-C_P7ACqV.js";import{d as B,c as v,v as D,R as ce,f as ue,B as I,h as P,T as y,I as w,V as O,X as me,Y as de}from"./ButtonGroup-Bgv38W4W.js";import{K as W,r as $,v as pe,s as ge,E as X,w as fe}from"./Page-DvtG3tiZ.js";import{F as Q,M as he,T as ve,B as be,a as Ee}from"./Modal-CEg-nmC-.js";import{I as Ce}from"./Image-04wlLHHA.js";import{L as Ne}from"./LegacyStack-g1cAJ6OF.js";import{a as Te,S as Se}from"./Banner-4MJ0AgcI.js";import{i as Fe}from"./index-CeTaglFb.js";import{C as Y}from"./CSSTransition-BI2FqCs3.js";var q=function(o){return t.createElement("svg",Object.assign({viewBox:"0 0 20 20"},o),t.createElement("path",{d:"M12.72 13.78a.75.75 0 1 0 1.06-1.06l-2.72-2.72 2.72-2.72a.75.75 0 0 0-1.06-1.06l-2.72 2.72-2.72-2.72a.75.75 0 0 0-1.06 1.06l2.72 2.72-2.72 2.72a.75.75 0 1 0 1.06 1.06l2.72-2.72 2.72 2.72Z"}))};q.displayName="XSmallIcon";function xe(){const n=s.useContext(Q);if(!n)throw new Error("No Frame context was provided. Your component must be wrapped in a <Frame> component. See https://polaris.shopify.com/components/internal-only/frame for implementation instructions.");return n}function H(n,o,e){if(!document)return;document.documentElement.style.setProperty(n,o)}var p={Frame:"Polaris-Frame",Navigation:"Polaris-Frame__Navigation",hasTopBar:"Polaris-Frame--hasTopBar","Navigation-enter":"Polaris-Frame__Navigation--enter","Navigation-enterActive":"Polaris-Frame__Navigation--enterActive","Navigation-exit":"Polaris-Frame__Navigation--exit","Navigation-exitActive":"Polaris-Frame__Navigation--exitActive",NavigationDismiss:"Polaris-Frame__NavigationDismiss","Navigation-visible":"Polaris-Frame__Navigation--visible",TopBar:"Polaris-Frame__TopBar",ContextualSaveBar:"Polaris-Frame__ContextualSaveBar",Main:"Polaris-Frame__Main",hasNav:"Polaris-Frame--hasNav",Content:"Polaris-Frame__Content",hasSidebar:"Polaris-Frame--hasSidebar",GlobalRibbonContainer:"Polaris-Frame__GlobalRibbonContainer",LoadingBar:"Polaris-Frame__LoadingBar",Skip:"Polaris-Frame__Skip",focused:"Polaris-Frame--focused"};function _e(){const n=s.useRef(!1);return s.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),n}var G={Loading:"Polaris-Frame-Loading",Level:"Polaris-Frame-Loading__Level"};const z=99;function Me(){const n=B(),o=_e(),[e,a]=s.useState(0),[r,i]=s.useState(!1);s.useEffect(()=>{e>=z||r||requestAnimationFrame(()=>{if(!o.current)return;const g=Math.max((z-e)/10,1);i(!0),a(e+g)})},[e,r,o]);const f={transform:`scaleX(${Math.floor(e)/100})`};return t.createElement("div",{className:G.Loading,"aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar","aria-label":n.translate("Polaris.Loading.label")},t.createElement("div",{className:G.Level,style:f,onTransitionEnd:()=>i(!1)}))}var U={startFade:"Polaris-Frame-CSSAnimation--startFade",endFade:"Polaris-Frame-CSSAnimation--endFade"},E;(function(n){n.Entering="entering",n.Entered="entered",n.Exiting="exiting",n.Exited="exited"})(E||(E={}));function Pe({in:n,className:o,type:e,children:a}){const[r,i]=s.useState(n?E.Entering:E.Exited),f=s.useRef(!1),g=s.useRef(null);s.useEffect(()=>{f.current&&r===E.Entering&&u(E.Entered)},[r]),s.useEffect(()=>{f.current&&(n&&u(E.Entering),!n&&u(E.Exiting))},[n]),s.useEffect(()=>{f.current=!0},[]);const h=v(o,U[D("start",e)],n&&U[D("end",e)]),N=r===E.Exited&&!n?null:a;return t.createElement("div",{className:h,ref:g,onTransitionEnd:m},N);function m(){r===E.Exiting&&u(E.Exited)}function u(d){i(d),d===E.Entering&&g.current&&g.current.getBoundingClientRect()}}function Z(n,o){if(!n)return null;const e=Object.keys(n);for(const a of e){if(a===o)return n[o];if(ce(n[a])){const r=Z(n[a],o);if(r)return r}}return null}function ye(n={},o=0,e="width"){const a=typeof n=="number"?n:Z(n,e);return a?`${a}px`:`${o}px`}var x={ContextualSaveBar:"Polaris-Frame-ContextualSaveBar",LogoContainer:"Polaris-Frame-ContextualSaveBar__LogoContainer",ContextControl:"Polaris-Frame-ContextualSaveBar__ContextControl",Contents:"Polaris-Frame-ContextualSaveBar__Contents",fullWidth:"Polaris-Frame-ContextualSaveBar--fullWidth",MessageContainer:"Polaris-Frame-ContextualSaveBar__MessageContainer",ActionContainer:"Polaris-Frame-ContextualSaveBar__ActionContainer"};function Be({open:n,onDiscard:o,onCancel:e}){const a=B();return t.createElement(he,{title:a.translate("Polaris.DiscardConfirmationModal.title"),open:n,onClose:e,primaryAction:{content:a.translate("Polaris.DiscardConfirmationModal.primaryAction"),destructive:!0,onAction:o},secondaryActions:[{content:a.translate("Polaris.DiscardConfirmationModal.secondaryAction"),onAction:e}],sectioned:!0},a.translate("Polaris.DiscardConfirmationModal.message"))}function Re({alignContentFlush:n,message:o,saveAction:e,discardAction:a,fullWidth:r,contextControl:i,secondaryMenu:f}){const g=B(),{logo:h}=xe(),{value:N,toggle:m,setFalse:u}=ue(!1),d=s.useCallback(()=>{a&&a.onAction&&a.onAction(),u()},[u,a]),l=a&&a.content?a.content:g.translate("Polaris.ContextualSaveBar.discard");let c;a&&a.discardConfirmationModal?c=m:a&&(c=a.onAction);const C=a&&a.onAction&&a.discardConfirmationModal&&t.createElement(Be,{open:N,onCancel:m,onDiscard:d}),b=a&&t.createElement(I,{variant:"tertiary",size:"large",url:a.url,onClick:c,loading:a.loading,disabled:a.disabled,accessibilityLabel:a.content},l),T=e&&e.content?e.content:g.translate("Polaris.ContextualSaveBar.save"),S=e&&t.createElement(I,{variant:"primary",tone:"success",size:"large",url:e.url,onClick:e.onAction,loading:e.loading,disabled:e.disabled,accessibilityLabel:e.content},T),M=ye(h,104),R=h&&t.createElement(Ce,{style:{width:M},source:h.contextualSaveBarSource||"",alt:""}),k=n||i?null:t.createElement("div",{className:x.LogoContainer,style:{width:M}},R),A=i?t.createElement("div",{className:x.ContextControl},i):null,L=v(x.Contents,r&&x.fullWidth);return t.createElement(t.Fragment,null,t.createElement("div",{className:x.ContextualSaveBar},A,k,t.createElement("div",{className:L},t.createElement("div",{className:x.MessageContainer},t.createElement(P,{source:Te}),o&&t.createElement(y,{as:"h2",variant:"headingMd",tone:"text-inverse",truncate:!0},o)),t.createElement("div",{className:x.ActionContainer},t.createElement(Ne,{spacing:"tight",wrap:!1},f,b,S)))),C)}function J(n,o=Fe){const e=s.useRef(n);return o(e.current,n)||(e.current=n),e.current}function ke(n,o,e){s.useEffect(n,J(o,e))}function Ae(n,o,e){return s.useCallback(n,J(o,e))}var _={ToastManager:"Polaris-Frame-ToastManager",ToastWrapper:"Polaris-Frame-ToastManager__ToastWrapper","ToastWrapper-enter":"Polaris-Frame-ToastManager__ToastWrapper--enter","ToastWrapper-exit":"Polaris-Frame-ToastManager__ToastWrapper--exit","ToastWrapper-enter-done":"Polaris-Frame-ToastManager--toastWrapperEnterDone"},F={Toast:"Polaris-Frame-Toast",Action:"Polaris-Frame-Toast__Action",error:"Polaris-Frame-Toast--error",CloseButton:"Polaris-Frame-Toast__CloseButton",LeadingIcon:"Polaris-Frame-Toast__LeadingIcon",toneMagic:"Polaris-Frame-Toast--toneMagic",WithActionOnComponent:"Polaris-Frame-Toast__WithActionOnComponent"};const Le=5e3,K=1e4;function De({content:n,onDismiss:o,duration:e,error:a,action:r,tone:i,onClick:f,icon:g,isHovered:h}){const m=r&&!e?K:e||Le,u=s.useRef(m),d=s.useRef(null),l=s.useRef(null);s.useEffect(()=>{function S(){d.current=Date.now(),l.current=setTimeout(()=>{o()},u.current)}function M(){d.current&&(u.current-=Date.now()-d.current),l.current&&clearTimeout(l.current),l.current=null}return h?M():S(),()=>{l.current&&clearTimeout(l.current)}},[h,o]),s.useEffect(()=>{r&&e&&e<K&&console.log("Toast with action should persist for at least 10,000 milliseconds to give the merchant enough time to act on it.")},[r,e]);const c=t.createElement("button",{type:"button",className:F.CloseButton,onClick:o},t.createElement(P,{source:q,tone:"inherit"})),C=r?t.createElement("div",{className:F.Action},t.createElement(I,{variant:"monochromePlain",removeUnderline:!0,size:"slim",onClick:r.onAction},r.content)):null;let b=null;a?b=t.createElement("div",{className:F.LeadingIcon},t.createElement(P,{source:pe,tone:"inherit"})):g&&(b=t.createElement("div",{className:F.LeadingIcon},t.createElement(P,{source:g,tone:"inherit"})));const T=v(F.Toast,a&&F.error,i&&F[D("tone",i)]);return!r&&f?t.createElement("button",{"aria-live":"assertive",className:v(T,F.WithActionOnComponent),type:"button",onClick:f},t.createElement(W,{keyCode:$.Escape,handler:o}),b,t.createElement(w,{gap:"400",blockAlign:"center"},t.createElement(y,Object.assign({as:"span",variant:"bodyMd",fontWeight:"medium"},i==="magic"&&{tone:"magic"}),n))):t.createElement("div",{className:T,"aria-live":"assertive"},t.createElement(W,{keyCode:$.Escape,handler:o}),b,t.createElement(w,{gap:"400",blockAlign:"center"},t.createElement(y,Object.assign({as:"span",variant:"bodyMd",fontWeight:"medium"},i==="magic"&&{tone:"magic"}),n)),C,c)}const Ie=10,j=30;function we(n){const o=e=>(e-1)*e/2;return n*Ie-o(n)}const Oe=s.memo(function({toastMessages:o}){const e=[],[a,r]=s.useState(!1),i=s.useRef(!1),f=s.useRef(null),g=s.useRef(null),h=Ae(()=>{const m=o.length-1;o.forEach((u,d)=>{const l=m-d,c=e[d];if(!c.current)return;const C=c.current.clientHeight,b=a?1:.9**l,T=we(l),S=a?C+(C-8)*l:C+T;c.current.style.setProperty("--pc-toast-manager-translate-y-in",`-${S}px`),c.current.style.setProperty("--pc-toast-manager-scale-in",`${b}`),c.current.style.setProperty("--pc-toast-manager-blur-in",a?"0":`${l*.5}px`),c.current.style.setProperty("--pc-toast-manager-transition-delay-in",`${a?l*j:0}ms`),c.current.style.setProperty("--pc-toast-manager-scale-out",`${l===0?.85:b**2}`),c.current.style.setProperty("--pc-toast-manager-translate-y-out",`${-S}px`)})},[o,e,a]);ke(()=>{h(),o.length===0&&r(!1),a?f.current=setTimeout(()=>{i.current=!0},o.length*j+400):f.current&&(clearTimeout(f.current),i.current=!1)},[o,a]);const N=o.map((m,u)=>{const d=o.length-u-1,l=s.createRef();e[u]=l;function c(){r(!0)}function C(){i.current&&r(!1)}return t.createElement(Y,{nodeRef:e[u],key:m.id,timeout:{enter:0,exit:200},classNames:We},t.createElement("div",{ref:l,onMouseEnter:d>0?c:C},t.createElement("div",{ref:b=>d===0?g.current=b:null},t.createElement(De,Object.assign({},m,{isHovered:a})))))});return t.createElement(ge,{idPrefix:"toast"},t.createElement(X,{event:"resize",handler:h}),t.createElement("div",{className:_.ToastManager,"aria-live":"assertive",onMouseEnter:function(m){var l;const u=m.target,d=(l=g.current)==null?void 0:l.contains(u);r(!d)},onMouseLeave:function(){r(!1)}},t.createElement(ve,{component:null},N)))}),We={enter:v(_.ToastWrapper,_["ToastWrapper-enter"]),enterDone:v(_.ToastWrapper,_["ToastWrapper-enter-done"]),exit:v(_.ToastWrapper,_["ToastWrapper-exit"])},V="AppFrameMain",$e="AppFrameNav",He="AppFrameTopBar",Ge="AppFrameLoadingBar";class ze extends s.PureComponent{constructor(...o){super(...o),this.state={skipFocused:!1,globalRibbonHeight:0,loadingStack:0,toastMessages:[],showContextualSaveBar:!1},this.contextualSaveBar=null,this.globalRibbonContainer=null,this.navigationNode=s.createRef(),this.setGlobalRibbonHeight=()=>{const{globalRibbonContainer:e}=this;e&&this.setState({globalRibbonHeight:e.offsetHeight},this.setGlobalRibbonRootProperty)},this.setOffset=()=>{const{offset:e="0px"}=this.props;H("--pc-frame-offset",e)},this.setGlobalRibbonRootProperty=()=>{const{globalRibbonHeight:e}=this.state;H("--pc-frame-global-ribbon-height",`${e}px`)},this.showToast=e=>{this.setState(({toastMessages:a})=>({toastMessages:a.find(({id:i})=>i===e.id)!=null?a:[...a,e]}))},this.hideToast=({id:e})=>{this.setState(({toastMessages:a})=>({toastMessages:a.filter(({id:r})=>e!==r)}))},this.setContextualSaveBar=e=>{const{showContextualSaveBar:a}=this.state;this.contextualSaveBar={...e},a===!0?this.forceUpdate():this.setState({showContextualSaveBar:!0})},this.removeContextualSaveBar=()=>{this.contextualSaveBar=null,this.setState({showContextualSaveBar:!1})},this.startLoading=()=>{this.setState(({loadingStack:e})=>({loadingStack:e+1}))},this.stopLoading=()=>{this.setState(({loadingStack:e})=>({loadingStack:Math.max(0,e-1)}))},this.handleResize=()=>{this.props.globalRibbon&&this.setGlobalRibbonHeight()},this.handleFocus=()=>{this.setState({skipFocused:!0})},this.handleBlur=()=>{this.setState({skipFocused:!1})},this.handleClick=e=>{const{skipToContentTarget:a}=this.props;a&&a.current&&(a.current.focus(),e==null||e.preventDefault())},this.handleNavigationDismiss=()=>{const{onNavigationDismiss:e}=this.props;e!=null&&e()},this.setGlobalRibbonContainer=e=>{this.globalRibbonContainer=e},this.handleNavKeydown=e=>{const{key:a}=e,{mediaQuery:{isNavigationCollapsed:r},showMobileNavigation:i}=this.props;r&&i&&a==="Escape"&&this.handleNavigationDismiss()}}componentDidMount(){this.handleResize(),!this.props.globalRibbon&&(this.setGlobalRibbonRootProperty(),this.setOffset())}componentDidUpdate(o){this.props.globalRibbon!==o.globalRibbon&&this.setGlobalRibbonHeight(),this.setOffset()}render(){const{skipFocused:o,loadingStack:e,toastMessages:a,showContextualSaveBar:r}=this.state,{logo:i,children:f,navigation:g,topBar:h,globalRibbon:N,showMobileNavigation:m=!1,skipToContentTarget:u,i18n:d,sidebar:l,mediaQuery:{isNavigationCollapsed:c}}=this.props,C=v(p.Navigation,m&&p["Navigation-visible"]),b=c&&!m,T=c&&m,S=T?0:-1,M={...T&&{"aria-modal":!0,role:"dialog"}},R=g?t.createElement(de,null,le=>t.createElement(Ee,{trapping:T},t.createElement(Y,{nodeRef:this.navigationNode,appear:c,exit:c,in:m,timeout:parseInt(le.motion["motion-duration-300"],10),classNames:Ue},t.createElement("div",Object.assign({key:"NavContent"},M,{"aria-label":d.translate("Polaris.Frame.navigationLabel"),ref:this.navigationNode,className:C,onKeyDown:this.handleNavKeydown,id:$e,hidden:b}),g,t.createElement("button",{type:"button",className:p.NavigationDismiss,onClick:this.handleNavigationDismiss,"aria-hidden":b||!c&&!m,"aria-label":d.translate("Polaris.Frame.Navigation.closeMobileNavigationLabel"),tabIndex:S},t.createElement(P,{source:Se})))))):null,k=e>0?t.createElement("div",{className:p.LoadingBar,id:Ge},t.createElement(Me,null)):null,A=h?t.createElement("div",Object.assign({className:p.TopBar},O.props,me.props,{id:He}),h):null,L=N?t.createElement("div",{className:p.GlobalRibbonContainer,ref:this.setGlobalRibbonContainer},N):null,ee=v(p.Skip,o&&p.focused),te=u!=null&&u.current?u.current.id:V,ae=t.createElement("div",{className:ee},t.createElement("a",{href:`#${te}`,onFocus:this.handleFocus,onBlur:this.handleBlur,onClick:this.handleClick},t.createElement(y,{as:"span",variant:"bodyLg",fontWeight:"medium"},d.translate("Polaris.Frame.skipToContent")))),ne=g?{"data-has-navigation":!0}:{},oe=v(p.Frame,g&&p.hasNav,h&&p.hasTopBar,l&&p.hasSidebar),re=t.createElement(Pe,{in:r,className:p.ContextualSaveBar,type:"fade"},t.createElement(Re,this.contextualSaveBar)),se=m&&c?t.createElement(be,{belowNavigation:!0,onClick:this.handleNavigationDismiss,onTouchStart:this.handleNavigationDismiss}):null,ie={logo:i,showToast:this.showToast,hideToast:this.hideToast,toastMessages:a,startLoading:this.startLoading,stopLoading:this.stopLoading,setContextualSaveBar:this.setContextualSaveBar,removeContextualSaveBar:this.removeContextualSaveBar};return t.createElement(Q.Provider,{value:ie},t.createElement("div",Object.assign({className:oe},O.props,ne),ae,A,R,re,k,se,t.createElement("main",{className:p.Main,id:V,"data-has-global-ribbon":!!N},t.createElement("div",{className:p.Content},f)),t.createElement(Oe,{toastMessages:a}),L,t.createElement(X,{event:"resize",handler:this.handleResize})))}}const Ue={enter:v(p["Navigation-enter"]),enterActive:v(p["Navigation-enterActive"]),enterDone:v(p["Navigation-enterActive"]),exit:v(p["Navigation-exit"]),exitActive:v(p["Navigation-exitActive"])};function et(n){const o=B(),e=fe();return t.createElement(ze,Object.assign({},n,{i18n:o,mediaQuery:e}))}export{et as F,ke as a,xe as u};
