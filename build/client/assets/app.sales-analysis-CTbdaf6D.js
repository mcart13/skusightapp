import{r as A,j as e}from"./index-C_P7ACqV.js";import{u as q,L as W}from"./components-DBQK_h67.js";import{P as O,C as f,b as d,T as a,c as z,B as N}from"./Page-D9F0KSCl.js";import{L as m}from"./Layout-Dcg5LYDO.js";import{P as V}from"./ProgressBar-DyqsZugm.js";import{S as Q}from"./Select-DwZWp0AG.js";import{D as F}from"./DataTable-CantQMvG.js";import"./context-CISPVU1J.js";import"./CSSTransition-BI2FqCs3.js";import"./Sticky-BQppF5j9.js";const D=n=>{const r=[];if(n.trend>10?r.push({factor:"Recent Sales Trend",impact:`+${Math.round(n.trend)}%`,description:`Sales are accelerating (+${Math.round(n.trend)}% in last 30 days)`}):n.trend<-10&&r.push({factor:"Recent Sales Trend",impact:`${Math.round(n.trend)}%`,description:`Sales are slowing down (${Math.round(n.trend)}% in last 30 days)`}),n.title.includes("Snowboard")){const j=new Date().getMonth();(j>=9||j<=1)&&r.push({factor:"Seasonal Pattern",impact:"+30%",description:"Winter season typically increases demand by 30% based on historical data"})}return n.stdDev>2&&r.push({factor:"Sales Variability",impact:"+15%",description:"High sales variability requires higher safety stock"}),r.push({factor:"Lead Time",impact:`${n.leadTime} days`,description:`Supplier typically takes ${n.leadTime} days to fulfill orders`}),r};function ae(){const{products:n}=q(),[r,j]=A.useState(""),C=t=>{const s=Math.floor(Math.random()*5)+1,o=Math.random()>.7?.1:Math.random()>.5?-.05:0,c=Math.random()>.7;return Array(30).fill(0).map((p,g)=>{let h=s;return h+=g*o,c&&(g%7===5||g%7===6)&&(h*=1.5),h+=Math.random()*2-1,Math.max(0,Math.round(h))})},l=n.edges.map(({node:t})=>{var T;const s=(T=t.variants.edges[0])==null?void 0:T.node,o=(s==null?void 0:s.inventoryQuantity)||0,c=C(t.id),p=c.reduce((x,y)=>x+y,0)/c.length,g=c.slice(0,15),h=c.slice(15),u=g.reduce((x,y)=>x+y,0)/g.length,L=h.reduce((x,y)=>x+y,0)/h.length,v=u>0?(L-u)/u*100:0,U=c.reduce((x,y)=>x+Math.pow(y-p,2),0)/c.length,k=Math.sqrt(U),b=Math.floor(Math.random()*5)+3,P=Math.ceil(1.645*k*Math.sqrt(b)),$=Math.ceil(p*b)+P;let S=p;Math.abs(v)>5&&(S=p*(1+v/100));const w=S>0?Math.ceil(o/S):1/0,R=S*365,B=20,E=parseFloat(s==null?void 0:s.price)*.2||5,H=Math.ceil(Math.sqrt(2*R*B/E));return{title:t.title,id:t.id,averageSales:parseFloat(p.toFixed(2)),adjustedAverageSales:parseFloat(S.toFixed(2)),currentStock:o,daysUntilStockout:w===1/0?"N/A":w,trend:parseFloat(v.toFixed(1)),stdDev:parseFloat(k.toFixed(2)),leadTime:b,safetyStock:P,reorderPoint:$,price:(s==null?void 0:s.price)||0,eoq:H}}),i=l.find(t=>t.id===r);A.useEffect(()=>{l.length>0&&!r&&j(l[0].id)},[l,r]),l.sort((t,s)=>s.averageSales-t.averageSales),l.map(t=>[t.title,t.adjustedAverageSales,t.currentStock,(typeof t.daysUntilStockout=="number",t.daysUntilStockout),t.trend>0?`+${t.trend}%`:`${t.trend}%`]);const I=l.map(t=>[t.title,t.safetyStock,t.reorderPoint,t.leadTime,t.eoq]),M=l.slice(0,5);return e.jsx(O,{title:"Sales Analysis",backAction:{content:"Inventory Dashboard",url:"/app"},primaryAction:e.jsx(W,{to:"/app/settings",children:e.jsx(N,{children:"Customize Settings"})}),children:e.jsxs(m,{children:[e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Top Products by Daily Sales"}),e.jsx(d,{gap:"400",children:M.map(t=>e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsx(a,{variant:"bodyMd",fontWeight:"bold",children:t.title}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxs(a,{variant:"bodyMd",children:[t.averageSales," units/day"]}),t.trend!==0&&e.jsx("span",{style:{marginLeft:"8px",color:t.trend>0?"#108043":"#DE3618",fontWeight:"bold"},children:t.trend>0?`↑ ${t.trend}%`:`↓ ${Math.abs(t.trend)}%`})]})]}),e.jsx(V,{progress:t.averageSales/M[0].averageSales*100,size:"small",color:"primary"})]},t.title))})]})})}),e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Forecast Explanations"}),e.jsxs("div",{children:[e.jsx(Q,{label:"Product",options:l.map(t=>({label:t.title,value:t.id})),value:r,onChange:t=>j(t)}),i&&e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(d,{gap:"400",children:[e.jsxs(a,{variant:"headingSm",children:["Why we're forecasting ",i.daysUntilStockout," days until stockout:"]}),e.jsx("div",{style:{marginTop:"8px"},children:D(i).map((t,s)=>e.jsxs("div",{style:{padding:"12px",marginBottom:"8px",borderLeft:"4px solid #5c6ac4",backgroundColor:"#F9FAFB"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(a,{variant:"bodyMd",fontWeight:"bold",children:t.factor}),e.jsx(a,{variant:"bodyMd",fontWeight:"bold",children:t.impact})]}),e.jsx(a,{variant:"bodyMd",children:t.description})]},s))}),e.jsx("div",{style:{marginTop:"12px"},children:e.jsx(a,{variant:"bodyMd",children:"The forecast combines your historical sales data, recent trends, seasonal patterns, and supplier lead times to provide the most accurate prediction."})})]})})]})]})})}),e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Forecast Visualization"}),i&&e.jsxs("div",{style:{marginTop:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"120px"},children:e.jsx(a,{children:"Current Stock"})}),e.jsx("div",{style:{flex:1,height:"24px",backgroundColor:"#DFE3E8",borderRadius:"3px",overflow:"hidden",position:"relative"},children:e.jsx("div",{style:{position:"absolute",height:"100%",width:`${Math.min(100,i.currentStock/(i.reorderPoint*2)*100)}%`,backgroundColor:"#5c6ac4"}})}),e.jsx("div",{style:{width:"60px",textAlign:"right"},children:e.jsxs(a,{children:[i.currentStock," units"]})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[e.jsx("div",{style:{width:"120px"},children:e.jsx(a,{children:"Reorder Point"})}),e.jsx("div",{style:{flex:1,height:"24px",borderRadius:"3px",position:"relative"},children:e.jsx("div",{style:{position:"absolute",height:"100%",left:`${Math.min(100,i.reorderPoint/(i.reorderPoint*2)*100)}%`,borderLeft:"2px dashed #bf0711",paddingLeft:"8px",display:"flex",alignItems:"center"},children:e.jsxs(a,{variant:"bodySm",color:"critical",children:["Reorder at ",i.reorderPoint]})})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"120px"},children:e.jsx(a,{children:"Safety Stock"})}),e.jsx("div",{style:{flex:1,height:"24px",borderRadius:"3px",position:"relative"},children:e.jsx("div",{style:{position:"absolute",height:"100%",left:`${Math.min(100,i.safetyStock/(i.reorderPoint*2)*100)}%`,borderLeft:"2px dashed #8c6e00",paddingLeft:"8px",display:"flex",alignItems:"center"},children:e.jsxs(a,{variant:"bodySm",color:"warning",children:["Safety stock: ",i.safetyStock]})})})]})]})]})})}),e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Inventory Health Overview"}),e.jsx(d,{gap:"400",children:l.map(t=>{let s="success",o="Healthy";return t.daysUntilStockout==="N/A"||t.daysUntilStockout===0?(s="critical",o="Out of Stock"):t.currentStock<=t.reorderPoint?(s="warning",o="Reorder Now"):t.daysUntilStockout<t.leadTime*2&&(s="attention",o="Order Soon"),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsx(a,{variant:"bodyMd",children:t.title}),e.jsx(z,{status:s,children:o})]},t.title)})})]})})}),e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Sales Velocity Analysis"}),e.jsx(F,{columnContentTypes:["text","numeric","numeric","text","text"],headings:["Product","Daily Sales (Adjusted)","Current Stock","Days Until Stockout","Primary Factor"],rows:l.map(t=>{const s=D(t),o=s.length>0?s[0].factor:"Regular sales pattern";return[t.title,t.adjustedAverageSales.toFixed(2),t.currentStock,(typeof t.daysUntilStockout=="number",t.daysUntilStockout),o]})}),e.jsx(a,{children:"Note: Sales trends are calculated based on last 30 days of sales."})]})})}),e.jsx(m.Section,{children:e.jsx(f,{children:e.jsxs(d,{gap:"500",children:[e.jsx(a,{as:"h2",variant:"headingMd",children:"Advanced Inventory Planning"}),e.jsx(F,{columnContentTypes:["text","numeric","numeric","numeric","numeric"],headings:["Product","Safety Stock","Reorder Point","Lead Time (Days)","Optimal Order Qty"],rows:I}),e.jsx(a,{children:"Safety stock and reorder points are calculated based on sales variability and lead times. The optimal order quantity minimizes total inventory costs."})]})})})]})})}export{ae as default};
